<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Discover Your Heroic Archetype</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Georgia', serif;
            background: linear-gradient(135deg, #0a0a1f 0%, #1a1a2e 50%, #16213e 100%);
            color: #f4f4f4;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        /* Navigation Bar */
        .navigation-bar {
            background: rgba(255,255,255,0.05);
            padding: 15px 0;
            margin-bottom: 30px;
            border-radius: 10px;
            backdrop-filter: blur(10px);
        }

        .nav-links {
            display: flex;
            justify-content: center;
            gap: 30px;
            flex-wrap: wrap;
        }

        .nav-link {
            color: #4ecdc4;
            text-decoration: none;
            font-size: 1.1rem;
            font-weight: bold;
            padding: 8px 16px;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .nav-link:hover {
            background: rgba(78, 205, 196, 0.1);
            transform: translateY(-2px);
        }

        .nav-link.active {
            color: #ffd700;
            background: rgba(255, 215, 0, 0.1);
        }

        .quiz-container {
            background: rgba(255,255,255,0.05);
            border-radius: 20px;
            padding: 40px;
            max-width: 900px;
            margin: 0 auto;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.1);
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        /* Pre-Quiz Section */
        .pre-quiz {
            text-align: center;
        }

        .quiz-title {
            font-size: 2.8rem;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            background: linear-gradient(45deg, #ffd700, #ff6b6b, #4ecdc4, #45b7d1);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .quiz-subtitle {
            font-size: 1.3rem;
            color: rgba(255,255,255,0.9);
            margin-bottom: 30px;
            line-height: 1.6;
        }

        .how-it-works {
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            text-align: left;
        }

        .how-it-works h3 {
            color: #ffd700;
            font-size: 1.5rem;
            margin-bottom: 20px;
            text-align: center;
        }

        .force-explanation {
            display: grid;
            gap: 20px;
            margin-bottom: 25px;
        }

        /* Force grid: 4 columns on large screens, 2 on medium, 1 on small */
        .force-explanation {
            grid-template-columns: repeat(4, 1fr);
        }

        @media (max-width: 1024px) {
            .force-explanation {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 640px) {
            .force-explanation {
                grid-template-columns: 1fr;
            }
        }

        .force-card {
            background: rgba(255,255,255,0.1);
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            border-top: 3px solid;
            transition: transform 0.3s ease;
        }

        .force-card:hover {
            transform: translateY(-3px);
        }

        .force-card.cowboy { border-top-color: #ff6b6b; }
        .force-card.wizard { border-top-color: #4ecdc4; }
        .force-card.pirate { border-top-color: #ffd700; }
        .force-card.knight { border-top-color: #45b7d1; }

        .force-icon {
            font-size: 2rem;
            margin-bottom: 10px;
            display: block;
        }

        .force-name {
            font-size: 1.1rem;
            font-weight: bold;
            color: #ffd700;
            margin-bottom: 8px;
        }

        .force-desc {
            font-size: 0.9rem;
            color: rgba(255,255,255,0.8);
            line-height: 1.4;
        }

        .explanation-text {
            text-align: center;
            color: rgba(255,255,255,0.9);
            line-height: 1.6;
            font-size: 1rem;
        }

        .quiz-instructions {
            background: rgba(255,215,0,0.1);
            border: 2px solid rgba(255,215,0,0.3);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 30px;
        }

        .quiz-instructions h4 {
            color: #ffd700;
            margin-bottom: 15px;
            font-size: 1.2rem;
        }

        .instruction-item {
            color: rgba(255,255,255,0.9);
            line-height: 1.6;
            margin-bottom: 8px;
        }

        .start-btn {
            background: linear-gradient(45deg, #ffd700, #ff6b6b);
            color: #000;
            border: none;
            padding: 15px 40px;
            border-radius: 30px;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 20px rgba(255,215,0,0.3);
        }

        .start-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(255,215,0,0.5);
        }

        /* Quiz Section */
        .quiz-section {
            display: none;
        }

        .quiz-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .quiz-header h2 {
            font-size: 2rem;
            color: #ffd700;
            margin-bottom: 10px;
        }

        .quiz-header p {
            color: rgba(255,255,255,0.8);
            font-size: 1rem;
        }

        .question {
            display: none;
            text-align: center;
        }

        .question.active {
            display: block;
        }

        .question-number {
            font-size: 1rem;
            color: #4ecdc4;
            margin-bottom: 20px;
            font-weight: bold;
        }

        .question-text {
            font-size: 1.4rem;
            margin-bottom: 40px;
            line-height: 1.6;
            color: #f4f4f4;
            min-height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0 20px;
        }

        .slider-container {
            margin-bottom: 30px;
        }

        .slider-labels {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            font-size: 1rem;
            color: rgba(255,255,255,0.8);
            font-weight: 500;
        }

        .left-label {
            text-align: left;
            flex: 1;
            padding-right: 20px;
        }

        .right-label {
            text-align: right;
            flex: 1;
            padding-left: 20px;
        }

        .slider {
            width: 100%;
            height: 10px;
            border-radius: 5px;
            background: linear-gradient(90deg, #ff6b6b, #ffd700, #4ecdc4);
            outline: none;
            opacity: 0.8;
            transition: opacity 0.2s;
            cursor: pointer;
        }

        .slider:hover {
            opacity: 1;
        }

        .slider::-webkit-slider-thumb {
            appearance: none;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background: #f4f4f4;
            cursor: pointer;
            border: 4px solid #ffd700;
            box-shadow: 0 3px 15px rgba(0,0,0,0.4);
            transition: all 0.2s ease;
        }

        .slider::-webkit-slider-thumb:hover {
            transform: scale(1.1);
            border-color: #ff6b6b;
        }

        .slider::-moz-range-thumb {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background: #f4f4f4;
            cursor: pointer;
            border: 4px solid #ffd700;
            box-shadow: 0 3px 15px rgba(0,0,0,0.4);
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 40px;
        }

        .nav-button {
            background: linear-gradient(45deg, #ffd700, #ff6b6b);
            color: #000;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .nav-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255,215,0,0.3);
        }

        .nav-button:disabled {
            background: #555;
            color: #999;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .progress-container {
            text-align: center;
        }

        .progress {
            color: #b8b8b8;
            font-size: 1rem;
            margin-bottom: 10px;
        }

        .progress-bar {
            width: 200px;
            height: 6px;
            background: rgba(255,255,255,0.2);
            border-radius: 3px;
            margin: 0 auto;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #ffd700, #ff6b6b);
            width: 3.33%;
            transition: width 0.3s ease;
            border-radius: 3px;
        }

        /* Results Loading */
        .results {
            display: none;
            text-align: center;
            padding: 60px 0;
        }

        .results.show {
            display: block;
        }

        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 5px solid rgba(255,215,0,0.3);
            border-top: 5px solid #ffd700;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 30px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading-text {
            font-size: 1.3rem;
            color: #ffd700;
            margin-bottom: 20px;
        }

        .loading-details {
            color: rgba(255,255,255,0.8);
            font-size: 1rem;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .quiz-container {
                padding: 25px;
            }
            
            .quiz-title {
                font-size: 2.2rem;
            }
            
            .question-text {
                font-size: 1.2rem;
                min-height: 60px;
            }
            
            .navigation {
                flex-direction: column;
                gap: 20px;
            }
            
            .progress-container {
                order: -1;
            }
        }

        @media (max-width: 480px) {
            .slider-labels {
                font-size: 0.9rem;
            }
            
            .left-label, .right-label {
                padding: 0 10px;
            }
            
            .navigation {
                gap: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Navigation Bar -->
        <nav class="navigation-bar">
            <div class="nav-links">
                <a href="index.html" class="nav-link">Home</a>
                <a href="take_quiz.html" class="nav-link active">Take Quiz</a>
                <a href="framework.html" class="nav-link">Framework</a>
                <a href="all_types.html" class="nav-link">All Types</a>
                <a href="compare_types.html" class="nav-link">Compare Types</a>
            </div>
        </nav>

        <div class="quiz-container">
            <!-- Pre-Quiz Section -->
            <div class="pre-quiz" id="preQuiz">
                <h1 class="quiz-title">Discover Your Heroic Archetype</h1>
                <p class="quiz-subtitle">
                    Uncover the fundamental forces that drive your approach to life, work, and relationships through our thoughtful personality assessment.
                </p>
                
                <div class="how-it-works">
                    <h3>üéØ How The Hero Compass Works</h3>
                    
                    <div class="force-explanation">
                        <div class="force-card cowboy">
                            <span class="force-icon">ü§†</span>
                            <div class="force-name">The Cowboy</div>
                            <div class="force-desc">Action-oriented, instinctive, learns through experience</div>
                        </div>
                        <div class="force-card wizard">
                            <span class="force-icon">üßô‚Äç‚ôÇÔ∏è</span>
                            <div class="force-name">The Wizard</div>
                            <div class="force-desc">Thoughtful, strategic, seeks wisdom and understanding</div>
                        </div>
                        <div class="force-card pirate">
                            <span class="force-icon">üè¥‚Äç‚ò†Ô∏è</span>
                            <div class="force-name">The Pirate</div>
                            <div class="force-desc">Independent, rebellious, values personal freedom</div>
                        </div>
                        <div class="force-card knight">
                            <span class="force-icon">‚öîÔ∏è</span>
                            <div class="force-name">The Knight</div>
                            <div class="force-desc">Service-oriented, dutiful, dedicated to causes</div>
                        </div>
                    </div>
                    
                    <p class="explanation-text">
                        Your personality is shaped by the balance of these four archetypal forces. Our assessment measures how much of each force drives your decisions, creating your individual heroic profile from 16 possible archetypes.
                    </p>
                </div>
                
                <div class="quiz-instructions">
                    <h4>üìã Before You Begin:</h4>
                    <div class="instruction-item">Answer honestly based on your natural tendencies, not who you think you should be</div>
                    <div class="instruction-item">Consider how you typically behave across different situations</div>
                    <div class="instruction-item">There are no right or wrong answers‚Äîevery archetype has its strengths</div>
                    <div class="instruction-item">The quiz takes about 5-7 minutes to complete</div>
                    <div class="instruction-item">Questions are intentionally simple‚Äîtrust your first instinct</div>
                </div>
                
                <button class="start-btn" onclick="startQuiz()">Begin Your Journey</button>
            </div>

            <!-- Quiz Section -->
            <div class="quiz-section" id="quizSection">
                <div class="quiz-header">
                    <h2>Your Heroic Assessment</h2>
                    <p>Answer based on your natural instincts and typical behavior</p>
                </div>

                <div id="quizQuestions">
                    <!-- Questions will be populated by JavaScript -->
                </div>

                <div class="navigation">
                    <button class="nav-button" id="prevBtn" onclick="changeQuestion(-1)" disabled>Previous</button>
                    <div class="progress-container">
                        <div class="progress" id="progress">1 / 30</div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="progressFill"></div>
                        </div>
                    </div>
                    <button class="nav-button" id="nextBtn" onclick="changeQuestion(1)">Next</button>
                </div>
            </div>

            <!-- Results Section -->
            <div class="results" id="results">
                <div class="loading-spinner"></div>
                <div class="loading-text">Analyzing your heroic profile...</div>
                <div class="loading-details">Calculating your force balance and determining your archetype</div>
            </div>
        </div>
    </div>

    <script>
        // Original quiz questions from the provided code - mix of meaningful and nonsensical
        const questionData = [
            // Meaningful questions (1-20)
            {
                text: "When facing a challenge, you prefer...",
                leftLabel: "Lightning Strike",
                rightLabel: "Chess Master",
                axis: "cowboy-wizard"
            },
            {
                text: "Your ideal weekend involves...",
                leftLabel: "Solo Adventure",
                rightLabel: "Group Service",
                axis: "pirate-knight"
            },
            {
                text: "You'd rather be known as...",
                leftLabel: "Wild Card",
                rightLabel: "Wise Oracle",
                axis: "cowboy-wizard"
            },
            {
                text: "Your spirit animal is closer to...",
                leftLabel: "Lone Wolf",
                rightLabel: "Pack Leader",
                axis: "pirate-knight"
            },
            {
                text: "In a crisis, you become...",
                leftLabel: "Storm Chaser",
                rightLabel: "Observatory",
                axis: "cowboy-wizard"
            },
            {
                text: "You're drawn to...",
                leftLabel: "Forbidden Knowledge",
                rightLabel: "Sacred Duty",
                axis: "pirate-knight"
            },
            {
                text: "Your decision-making style is like...",
                leftLabel: "Shooting Star",
                rightLabel: "Ancient Tree",
                axis: "cowboy-wizard"
            },
            {
                text: "You value...",
                leftLabel: "Personal Freedom",
                rightLabel: "Collective Honor",
                axis: "pirate-knight"
            },
            {
                text: "Your approach to learning is...",
                leftLabel: "Trial by Fire",
                rightLabel: "Library Scholar",
                axis: "cowboy-wizard"
            },
            {
                text: "You're motivated by...",
                leftLabel: "Breaking Chains",
                rightLabel: "Building Bridges",
                axis: "pirate-knight"
            },
            {
                text: "Your energy is like...",
                leftLabel: "Wildfire",
                rightLabel: "Deep Ocean",
                axis: "cowboy-wizard"
            },
            {
                text: "You prefer to work...",
                leftLabel: "Rogue Agent",
                rightLabel: "Team Captain",
                axis: "pirate-knight"
            },
            {
                text: "Your relationship with rules is...",
                leftLabel: "Demolition",
                rightLabel: "Architecture",
                axis: "cowboy-wizard"
            },
            {
                text: "You see authority as...",
                leftLabel: "Chains to Break",
                rightLabel: "Shield to Honor",
                axis: "pirate-knight"
            },
            {
                text: "Your wisdom comes from...",
                leftLabel: "Battle Scars",
                rightLabel: "Ancient Texts",
                axis: "cowboy-wizard"
            },
            {
                text: "Your legacy should be...",
                leftLabel: "Revolutionary",
                rightLabel: "Protector",
                axis: "pirate-knight"
            },
            {
                text: "Your superpower would be...",
                leftLabel: "Lightning Speed",
                rightLabel: "Time Control",
                axis: "cowboy-wizard"
            },
            {
                text: "Your heart belongs to...",
                leftLabel: "Open Road",
                rightLabel: "Home Hearth",
                axis: "pirate-knight"
            },
            {
                text: "Your philosophy aligns with...",
                leftLabel: "Leap of Faith",
                rightLabel: "Careful Study",
                axis: "cowboy-wizard"
            },
            {
                text: "Your greatest strength is...",
                leftLabel: "Unstoppable Will",
                rightLabel: "Unshakable Foundation",
                axis: "pirate-knight"
            },
            // Nonsensical questions (21-30)
            {
                text: "Choose your instinctive preference...",
                leftLabel: "Banana",
                rightLabel: "Hammer",
                axis: "cowboy-wizard"
            },
            {
                text: "Your gut reaction leans toward...",
                leftLabel: "Purple Tuesday",
                rightLabel: "Green Symphony",
                axis: "pirate-knight"
            },
            {
                text: "Between these, you're drawn to...",
                leftLabel: "Flying Toaster",
                rightLabel: "Sleeping Library",
                axis: "cowboy-wizard"
            },
            {
                text: "Your spirit resonates with...",
                leftLabel: "Quantum Socks",
                rightLabel: "Velvet Mathematics",
                axis: "pirate-knight"
            },
            {
                text: "You instinctively prefer...",
                leftLabel: "Dancing Scissors",
                rightLabel: "Whispering Telescope",
                axis: "cowboy-wizard"
            },
            {
                text: "Your essence aligns with...",
                leftLabel: "Rebel Spoon",
                rightLabel: "Noble Doorknob",
                axis: "pirate-knight"
            },
            {
                text: "Between these nonsensical options...",
                leftLabel: "Exploding Marshmallow",
                rightLabel: "Meditative Clock",
                axis: "cowboy-wizard"
            },
            {
                text: "Your subconscious gravitates toward...",
                leftLabel: "Invisible Motorcycle",
                rightLabel: "Collective Sandwich",
                axis: "pirate-knight"
            },
            {
                text: "Your inner self prefers...",
                leftLabel: "Spontaneous Pencil",
                rightLabel: "Ancient WiFi",
                axis: "cowboy-wizard"
            },
            {
                text: "Finally, you're fundamentally more...",
                leftLabel: "Chaotic Bubble",
                rightLabel: "Harmonious Brick",
                axis: "pirate-knight"
            }
        ];

        let currentQuestion = 0;
        let answers = [];
        let shuffledIndices = [];

        function shuffleArray(array) {
            const shuffled = [...array];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }

        function startQuiz() {
            document.getElementById('preQuiz').style.display = 'none';
            document.getElementById('quizSection').style.display = 'block';
            initializeQuiz();
        }

        function initializeQuiz() {
            // Create shuffled indices
            shuffledIndices = shuffleArray(Array.from({length: questionData.length}, (_, i) => i));
            
            // Create question elements
            const quizContainer = document.getElementById('quizQuestions');
            
            shuffledIndices.forEach((originalIndex, newIndex) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = newIndex === 0 ? 'question active' : 'question';
                questionDiv.setAttribute('data-question', newIndex);
                questionDiv.setAttribute('data-original-index', originalIndex);
                
                // Randomly flip some questions
                const shouldFlip = Math.random() > 0.5;
                questionData[originalIndex].flipped = shouldFlip;
                
                const leftLabel = shouldFlip ? questionData[originalIndex].rightLabel : questionData[originalIndex].leftLabel;
                const rightLabel = shouldFlip ? questionData[originalIndex].leftLabel : questionData[originalIndex].rightLabel;
                
                questionDiv.innerHTML = `
                    <div class="question-number">Question ${newIndex + 1} of 30</div>
                    <div class="question-text">${questionData[originalIndex].text}</div>
                    <div class="slider-container">
                        <div class="slider-labels">
                            <span class="left-label">${leftLabel}</span>
                            <span class="right-label">${rightLabel}</span>
                        </div>
                        <input type="range" min="1" max="7" value="4" class="slider" data-axis="${questionData[originalIndex].axis}">
                    </div>
                `;
                
                quizContainer.appendChild(questionDiv);
            });
        }

        function changeQuestion(direction) {
            if (direction === 1 && currentQuestion < 29) {
                // Save current answer
                const currentSlider = document.querySelector('.question.active .slider');
                const currentQuestionDiv = document.querySelector('.question.active');
                const originalIndex = parseInt(currentQuestionDiv.getAttribute('data-original-index'));
                
                let answer = parseInt(currentSlider.value);
                
                // Flip answer if question direction was flipped
                if (questionData[originalIndex].flipped) {
                    answer = 8 - answer;
                }
                
                answers[currentQuestion] = answer;
                
                // Move to next question
                document.querySelector('.question.active').classList.remove('active');
                currentQuestion++;
                document.querySelector(`[data-question="${currentQuestion}"]`).classList.add('active');
                
                updateNavigation();
                
                if (currentQuestion === 29) {
                    document.getElementById('nextBtn').textContent = 'See Results';
                }
            } else if (direction === -1 && currentQuestion > 0) {
                // Move to previous question
                document.querySelector('.question.active').classList.remove('active');
                currentQuestion--;
                document.querySelector(`[data-question="${currentQuestion}"]`).classList.add('active');
                
                updateNavigation();
                
                // Restore previous answer
                if (answers[currentQuestion] !== undefined) {
                    const currentQuestionDiv = document.querySelector('.question.active');
                    const originalIndex = parseInt(currentQuestionDiv.getAttribute('data-original-index'));
                    let displayAnswer = answers[currentQuestion];
                    
                    // Flip display answer if question direction was flipped
                    if (questionData[originalIndex].flipped) {
                        displayAnswer = 8 - displayAnswer;
                    }
                    
                    document.querySelector('.question.active .slider').value = displayAnswer;
                }
                
                document.getElementById('nextBtn').textContent = 'Next';
            } else if (direction === 1 && currentQuestion === 29) {
                // Save final answer and show results
                const currentSlider = document.querySelector('.question.active .slider');
                const currentQuestionDiv = document.querySelector('.question.active');
                const originalIndex = parseInt(currentQuestionDiv.getAttribute('data-original-index'));
                
                let answer = parseInt(currentSlider.value);
                
                // Flip answer if question direction was flipped
                if (questionData[originalIndex].flipped) {
                    answer = 8 - answer;
                }
                
                answers[currentQuestion] = answer;
                
                showResults();
            }
        }

        function updateNavigation() {
            document.getElementById('prevBtn').disabled = currentQuestion === 0;
            document.getElementById('progress').textContent = `${currentQuestion + 1} / 30`;
            
            // Update progress bar
            const progressPercent = ((currentQuestion + 1) / 30) * 100;
            document.getElementById('progressFill').style.width = progressPercent + '%';
        }

        function calculatePersonality() {
            let cowboyWizardTotal = 0;
            let pirateKnightTotal = 0;
            let cowboyWizardCount = 0;
            let pirateKnightCount = 0;

            answers.forEach((answer, questionIndex) => {
                const currentQuestionDiv = document.querySelector(`[data-question="${questionIndex}"]`);
                const originalIndex = parseInt(currentQuestionDiv.getAttribute('data-original-index'));
                const axis = questionData[originalIndex].axis;
                
                if (axis === 'cowboy-wizard') {
                    cowboyWizardTotal += answer;
                    cowboyWizardCount++;
                } else if (axis === 'pirate-knight') {
                    pirateKnightTotal += answer;
                    pirateKnightCount++;
                }
            });

            const cowboyWizardAvg = cowboyWizardTotal / cowboyWizardCount;
            const pirateKnightAvg = pirateKnightTotal / pirateKnightCount;

            // Calculate percentages for each force
            const cowboyPercent = Math.round(((cowboyWizardAvg - 1) / 6) * 100);
            const wizardPercent = 100 - cowboyPercent;
            const piratePercent = Math.round(((pirateKnightAvg - 1) / 6) * 100);
            const knightPercent = 100 - piratePercent;

            // Determine archetype based on dominant forces with more nuanced logic
            let archetypeKey = 'maverick-balanced'; // default
            
            // Use the same logic as the results page expects
            if (pirateKnightAvg <= 3.5) { // More Pirate
                if (cowboyWizardAvg <= 2.5) {
                    archetypeKey = 'maverick-pure'; // The Wildcard
                } else if (cowboyWizardAvg <= 3.5) {
                    archetypeKey = 'maverick-free-spirit'; // The Drifter
                } else if (cowboyWizardAvg <= 4.5) {
                    archetypeKey = 'maverick-balanced'; // The Maverick
                } else if (cowboyWizardAvg <= 5.5) {
                    archetypeKey = 'maverick-rebel-thinker'; // The Contrarian
                } else {
                    archetypeKey = 'rogue-strategic'; // The Treasure Hunter
                }
            } else { // More Knight
                if (cowboyWizardAvg <= 2.5) {
                    archetypeKey = 'champion-warrior'; // The Crusader
                } else if (cowboyWizardAvg <= 3.5) {
                    archetypeKey = 'champion-pure'; // The Paladin
                } else if (cowboyWizardAvg <= 4.5) {
                    archetypeKey = 'champion-balanced'; // The Guardian
                } else if (cowboyWizardAvg <= 5.5) {
                    archetypeKey = 'champion-activist'; // The Activist
                } else {
                    archetypeKey = 'sage-advisor'; // The Advisor
                }
            }

            // More nuanced mapping for extreme scores
            if (pirateKnightAvg <= 2) { // Very Pirate
                if (cowboyWizardAvg >= 6) {
                    archetypeKey = 'rogue-pure'; // The Mapmaker
                } else if (cowboyWizardAvg >= 5) {
                    archetypeKey = 'rogue-individualist'; // The Seeker
                }
            } else if (pirateKnightAvg >= 6) { // Very Knight
                if (cowboyWizardAvg >= 6) {
                    archetypeKey = 'sage-pure'; // The Archon
                } else if (cowboyWizardAvg >= 5) {
                    archetypeKey = 'sage-counselor'; // The Oracle
                } else if (cowboyWizardAvg <= 3) {
                    archetypeKey = 'champion-pure'; // The Paladin
                }
            }

            // Handle balanced middle scores
            if (pirateKnightAvg > 3.5 && pirateKnightAvg < 4.5) {
                if (cowboyWizardAvg > 3.5 && cowboyWizardAvg < 4.5) {
                    archetypeKey = 'sage-balanced'; // The Mentor (most balanced)
                } else if (cowboyWizardAvg >= 5) {
                    archetypeKey = 'rogue-balanced'; // The Wayfinder
                }
            }

            return {
                archetype: archetypeKey,
                forces: {
                    cowboy: cowboyPercent,
                    wizard: wizardPercent,
                    pirate: piratePercent,
                    knight: knightPercent
                },
                responses: answers
            };
        }

        function showResults() {
            // Hide quiz questions
            document.getElementById('quizSection').style.display = 'none';
            
            // Show loading
            document.getElementById('results').classList.add('show');
            
            // Calculate results
            const personality = calculatePersonality();
            
            // Store results for the enhanced results page
            const enhancedResults = {
                archetype: personality.archetype,
                forces: personality.forces,
                responses: personality.responses,
                timestamp: new Date().toISOString()
            };
            
            // Store in sessionStorage for the results page
            sessionStorage.setItem('quizResults', JSON.stringify(enhancedResults));
            
            // Simulate processing time and redirect to enhanced results page
            setTimeout(() => {
                window.location.href = 'enhanced_results.html';
            }, 2500);
        }

        // Initialize on page load - show pre-quiz by default
        document.addEventListener('DOMContentLoaded', function() {
            // Pre-quiz is shown by default
            // Quiz section and results are hidden until triggered
        });
    </script>
</body>
</html>